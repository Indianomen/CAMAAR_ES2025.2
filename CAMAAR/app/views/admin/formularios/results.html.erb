<style>
  .results-container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem;
  }
  
  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #e9ecef;
  }
  
  .page-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: #2c3e50;
    margin: 0;
  }
  
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }
  
  .stat-card {
    background: white;
    border-radius: 8px;
    padding: 1.5rem;
    text-align: center;
    border: 1px solid #e9ecef;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }
  
  .stat-value {
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }
  
  .answers-section {
    margin-top: 2rem;
  }
  
  .question-answers {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: white;
    border-radius: 8px;
    border: 1px solid #e9ecef;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }
  
  .answer-item {
    padding: 1rem;
    margin-bottom: 0.75rem;
    background: #f8f9fa;
    border-radius: 6px;
    border-left: 4px solid #28a745;
  }
  
  .answer-meta {
    font-size: 0.875rem;
    color: #6c757d;
    margin-top: 0.5rem;
  }
  
  /* Button styles matching templates */
  .btn-group {
    display: flex;
    gap: 0.5rem;
  }
  
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 0.75rem 1.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    text-decoration: none;
    cursor: pointer;
    border: 1px solid;
    border-radius: 6px;
    transition: all 0.2s ease;
  }
  
  .btn-outline {
    background: transparent;
    color: #6c757d;
    border-color: #6c757d;
  }
  
  .btn-outline:hover {
    background: #6c757d;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(108, 117, 125, 0.2);
  }
  
  .btn-primary {
    background: #007bff;
    color: white;
    border-color: #007bff;
  }
  
  .btn-primary:hover {
    background: #0056b3;
    border-color: #0056b3;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.2);
  }
  
  .btn-success {
    background: #28a745;
    color: white;
    border-color: #28a745;
  }
  
  .btn-success:hover {
    background: #218838;
    border-color: #1e7e34;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(40, 167, 69, 0.2);
  }
  
  /* Alert styles */
  .alert {
    padding: 1rem;
    border-radius: 6px;
    margin-bottom: 1.5rem;
    border: 1px solid transparent;
  }
  
  .alert-info {
    background-color: #d1ecf1;
    border-color: #bee5eb;
    color: #0c5460;
  }
  
  .alert-warning {
    background-color: #fff3cd;
    border-color: #ffeaa7;
    color: #856404;
  }
  
  /* Text utilities */
  .text-success {
    color: #28a745;
  }
  
  .text-warning {
    color: #ffc107;
  }
  
  .text-muted {
    color: #6c757d;
  }
</style>


<div class="results-container">
  <!-- Header with buttons -->
  <div class="page-header">
    <div>
      <h1 class="page-title">üìä Resultados: <%= @formulario.template.nome %></h1>
      <p class="text-muted" style="margin-top: 0.5rem;">
        Turma: <%= @formulario.turma.disciplina.nome %> (<%= @formulario.turma.semestre %>)
      </p>
    </div>
    
    <div class="btn-group">
      <!-- Voltar ao formul√°rio -->
      <%= link_to admin_formulario_path(@formulario), class: 'btn btn-outline' do %>
        <span>‚Üê</span>
        <span>Voltar ao Formul√°rio</span>
      <% end %>

      <!-- Exportar CSV -->
      <%= link_to export_csv_admin_formulario_path(@formulario, format: :csv),
                  class: 'btn btn-primary',
                  data: { turbo: false },
                  download: "resultados_formulario_#{@formulario.id}.csv" do %>
        <span>üì•</span>
        <span>Exportar CSV</span>
      <% end %>

      <!-- Enviar para alunos (se ainda n√£o enviado) -->
      <% unless @formulario.alunos_respostas.any? %>
        <%= button_to send_to_students_admin_formulario_path(@formulario),
              method: :post,
              form: { 
                data: { 
                  turbo_confirm: 'Enviar este formul√°rio para todos os alunos da turma?'
                },
                class: "inline-btn-form"
              },
              class: "btn btn-success" do %>
          <span>üì§</span>
          <span>Enviar para Alunos</span>
        <% end %>
      <% end %>
    </div>
  </div>
  
  <!-- Info Alert -->
  <div class="alert alert-info">
    <strong>‚ö†Ô∏è Dados An√¥nimos:</strong> As respostas s√£o exibidas de forma an√¥nima. 
    N√£o √© poss√≠vel identificar qual aluno respondeu cada avalia√ß√£o.
  </div>
  
  <!-- Statistics Cards -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-value"><%= @total_students %></div>
      <div class="stat-label">Alunos na Turma</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-value"><%= @total_responses %></div>
      <div class="stat-label">Responderam</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-value <%= @response_rate >= 70 ? 'text-success' : 'text-warning' %>">
        <%= @response_rate %>%
      </div>
      <div class="stat-label">Taxa de Resposta</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-value"><%= @formulario.perguntas.count %></div>
      <div class="stat-label">Perguntas</div>
    </div>
  </div>
  
  <!-- Answers Section -->
  <div class="answers-section">
    <h3>Respostas por Pergunta</h3>
    
    <% if @answers_by_question.any? %>
      <% @answers_by_question.each do |pergunta, respostas| %>
        <div class="question-answers">
          <h4 style="margin-bottom: 0.5rem;"><%= pergunta.texto %></h4>
          <p class="text-muted" style="margin-bottom: 1rem;">
            <%= respostas.count %> respostas recebidas
          </p>
          
          <% respostas.each do |resposta| %>
            <div class="answer-item">
              <div class="answer-text">
                <%= resposta.texto %>
              </div>
              <div class="answer-meta">
                Respondido em: <%= l(resposta.created_at, format: :short) %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <div class="alert alert-warning">
        Nenhuma resposta recebida para este formul√°rio ainda.
      </div>
    <% end %>
  </div>
</div>


<style>
  .inline-btn-form {
    display: inline;
    margin: 0;
    padding: 0;
  }
  
  .inline-btn-form button {
    all: unset;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 0.75rem 1.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: 6px;
    border: 1px solid;
    transition: all 0.2s ease;
    background-color: #28a745;
    color: white;
    border-color: #28a745;
  }
  
  .inline-btn-form button:hover {
    background-color: #218838;
    border-color: #1e7e34;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(40, 167, 69, 0.2);
  }
</style>